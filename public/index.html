<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>温岭检察打印助手</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="vendor/bootstrap-icons/font/bootstrap-icons.css">
</head>

<body>
    <a href="http://143.86.170.164:10086" target="_blank" class="transfer-station">
        <i class="bi bi-cloud-upload"></i>
        <span class="label">文件中转站</span>
    </a>
    <div class="container" style="position: relative;">
        <div style="position: absolute; top: 20px; right: 20px; z-index: 10;">
            <button id="openMergeModalBtn" class="btn-secondary">
                <i class="bi bi-file-earmark-word-fill"></i> WORD批量合并
            </button>
        </div>
        <header>
            <h1><i class="bi bi-printer"></i> 温岭检察打印助手</h1>
            <p class="subtitle">目前仅允许打印PDF，如需打印WORD，请先另存为PDF</p>
        </header>

        <main>
            <div class="card">
                <div class="upload-area" id="uploadArea">
                    <i class="bi bi-cloud-arrow-up-fill"></i>
                    <p>拖拽文件到此处或点击上传<strong> (支持批量拖拽上传)</strong></p>
                    <input type="file" id="fileInput" multiple hidden>
                </div>

                <div class="files-list" id="filesList" style="display: none;">
                    <!-- 文件列表将通过JavaScript动态加载 -->
                </div>

                <div class="printer-selection">
                    <h3>选择打印机位置</h3>
                    <div class="printer-list" id="printerList">
                        <!-- 打印机列表将通过JavaScript动态加载 -->
                    </div>
                </div>

                <div class="print-options">
                    <h3>打印选项</h3>
                    <div class="option-group">
                        <label for="pageRange">页面范围：</label>
                        <input type="text" id="pageRange" placeholder="例如：1-5,8,11-13">
                    </div>
                    <div class="option-group">
                        <label for="copies">打印份数：</label>
                        <input type="number" id="copies" min="1" value="1">
                    </div>
                </div>

                <button class="btn-primary" id="printBtn" disabled>
                    <i class="bi bi-printer-fill"></i> 发送打印
                </button>
            </div>
        </main>

        <div id="notification" class="notification">
            <p id="notificationText"></p>
        </div>

        <!-- WORD合并模态框 -->
        <div id="mergeModal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h2><i class="bi bi-file-earmark-word-fill"></i> WORD批量合并</h2>


                <div class="upload-area" id="mergeUploadArea">
                    <i class="bi bi-cloud-arrow-up-fill"></i>
                    <p>拖拽文件到此处或点击上传</p>
                    <input type="file" id="mergeFileInput" multiple hidden accept=".doc,.docx">
                </div>

                <div class="files-list" id="mergeFilesList">
                    <!-- 文件列表 -->
                </div>

                <button class="btn-primary" id="startMergeBtn" disabled>
                    <i class="bi bi-intersect"></i> 开始合并
                </button>
            </div>
        </div>

        <footer>
            <p><a href="config.html">打印机配置</a> (请勿修改) | 技术支持：<a href="tel:+86086162">86086162</a></p>
            <p>&copy; 2026 温岭市人民检察院</p>
        </footer>
    </div>

    <script type="module" src="js/main.js"></script>
</body>

</html>